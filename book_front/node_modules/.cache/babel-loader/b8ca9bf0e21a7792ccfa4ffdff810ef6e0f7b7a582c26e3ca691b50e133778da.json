{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{Link,useNavigate}from\"react-router-dom\";import BookUpdate from\"./BookWrite\";import\"./book.css\";import axios from\"axios\";import PageNavi from\"./PageNavi\";import Swal from\"sweetalert2\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BookList=()=>{const backServer=process.env.REACT_APP_BACK_SERVER;const[bookList,setBookList]=useState([]);const[reqPage,setReqPage]=useState(1);const[pi,setPi]=useState({});const[searchTerm,setSearchTerm]=useState(\"\");// 검색어 상태 추가\n// 검색어가 변경될 때마다 호출되는 useEffect\nuseEffect(()=>{setBookList([]);axios.get(`${backServer}/api/books`,{params:{page:reqPage,searchTerm}})// 검색어 추가된 파라미터\n.then(res=>{setBookList(res.data.list);// 목록\nsetPi(res.data.pi);// 페이징\n}).catch(err=>{//console.log(err);\n});},[reqPage,searchTerm]);// 검색어와 페이지가 바뀔 때마다 호출\nconst handleSearchChange=e=>{setSearchTerm(e.target.value);// 검색어 상태 업데이트\n};return/*#__PURE__*/_jsxs(\"section\",{className:\"list-wrap\",style:{width:\"100%\"},children:[/*#__PURE__*/_jsx(\"div\",{className:\"page-title\",children:\"Book List\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-wrap\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-bar\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\uC81C\\uBAA9 \\uB610\\uB294 \\uC800\\uC790 \\uAC80\\uC0C9\",value:searchTerm,onChange:handleSearchChange// 검색어 입력 변경 처리\n})}),/*#__PURE__*/_jsx(\"div\",{className:\"write-wrap\",children:/*#__PURE__*/_jsx(Link,{to:\"/book/write\",className:\"btn-primary\",children:\"\\uCC45\\uB4F1\\uB85D\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"book-list-wrap\",children:/*#__PURE__*/_jsx(\"ul\",{className:\"list-wrap\",children:bookList.map((book,i)=>{return/*#__PURE__*/_jsx(BookItem,{book:book,setBookList:setBookList},i);})})}),/*#__PURE__*/_jsx(\"div\",{className:\"board-paging-warp\",children:/*#__PURE__*/_jsx(PageNavi,{pi:pi,reqPage:reqPage,setReqPage:setReqPage})})]});};const BookItem=props=>{const backServer=process.env.REACT_APP_BACK_SERVER;const book=props.book;const navigate=useNavigate();const{setBookList}=props;const[stockCount,setStockCount]=useState(book.salesCount);// 재고 상태 추가\n// 재고 수정 함수\nconst handleStockChange=()=>{if(stockCount<0){Swal.fire({icon:\"error\",title:\"오류\",text:\"재고는 0 이상이어야 합니다.\"});return;}axios.put(`${backServer}/api/books/${book.id}/update/${stockCount}`).then(res=>{Swal.fire({icon:\"success\",title:\"성공\",text:\"재고가 성공적으로 업데이트되었습니다.\"});}).catch(err=>{Swal.fire({icon:\"error\",title:\"오류\",text:\"재고 업데이트 중 오류가 발생했습니다.\"});});};// 책 삭제 함수\nconst handleDelete=()=>{Swal.fire({title:`${book.title} 책을 삭제하시겠습니까?`,showCancelButton:true,confirmButtonText:\"삭제\",cancelButtonText:\"취소\"}).then(result=>{if(result.isConfirmed){axios.delete(`${backServer}/api/books/${book.id}`).then(res=>{Swal.fire({icon:\"success\",title:\"삭제 성공\",text:`${book.title} 책이 삭제되었습니다.`});// 책이 삭제되면 현재 목록에서 해당 책을 제거\nsetBookList(prevList=>prevList.filter(item=>item.id!==book.id));}).catch(err=>{Swal.fire({icon:\"error\",title:\"오류\",text:\"책 삭제 중 오류 발생\"});});}});};return/*#__PURE__*/_jsxs(\"li\",{className:\"posting-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"posting-img\",children:/*#__PURE__*/_jsx(\"img\",{src:book.image?book.image:\"/image/default_img.png\",alt:book.title,onClick:()=>{navigate(`/book/view/${book.id}`);}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"posting-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"posting-title\",children:book.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"posting-sub-info\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\uC800\\uC790 : \",book.author]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\uCD9C\\uD310\\uC0AC : \",book.publisher]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\uD310\\uB9E4 : \",book.salesCount]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\uC7AC\\uACE0 :\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:stockCount,onChange:e=>setStockCount(parseInt(e.target.value)),min:\"0\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-list\",onClick:handleStockChange,children:\"\\uC218\\uC815\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"delete-book\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn-list\",onClick:handleDelete,children:\"\\uC0AD\\uC81C\"})})]});};export default BookList;","map":{"version":3,"names":["React","useEffect","useState","Link","useNavigate","BookUpdate","axios","PageNavi","Swal","jsx","_jsx","jsxs","_jsxs","BookList","backServer","process","env","REACT_APP_BACK_SERVER","bookList","setBookList","reqPage","setReqPage","pi","setPi","searchTerm","setSearchTerm","get","params","page","then","res","data","list","catch","err","handleSearchChange","e","target","value","className","style","width","children","type","placeholder","onChange","to","map","book","i","BookItem","props","navigate","stockCount","setStockCount","salesCount","handleStockChange","fire","icon","title","text","put","id","handleDelete","showCancelButton","confirmButtonText","cancelButtonText","result","isConfirmed","delete","prevList","filter","item","src","image","alt","onClick","author","publisher","parseInt","min"],"sources":["/Users/ori/Desktop/project/book/book_front/src/components/book/BookList.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport BookUpdate from \"./BookWrite\";\nimport \"./book.css\";\nimport axios from \"axios\";\nimport PageNavi from \"./PageNavi\";\nimport Swal from \"sweetalert2\";\n\nconst BookList = () => {\n  const backServer = process.env.REACT_APP_BACK_SERVER;\n  const [bookList, setBookList] = useState([]);\n  const [reqPage, setReqPage] = useState(1);\n  const [pi, setPi] = useState({});\n  const [searchTerm, setSearchTerm] = useState(\"\"); // 검색어 상태 추가\n\n  // 검색어가 변경될 때마다 호출되는 useEffect\n  useEffect(() => {\n    setBookList([]);\n    axios\n      .get(`${backServer}/api/books`, { params: { page: reqPage, searchTerm } }) // 검색어 추가된 파라미터\n      .then((res) => {\n        setBookList(res.data.list); // 목록\n        setPi(res.data.pi); // 페이징\n      })\n      .catch((err) => {\n        //console.log(err);\n      });\n  }, [reqPage, searchTerm]); // 검색어와 페이지가 바뀔 때마다 호출\n\n  const handleSearchChange = (e) => {\n    setSearchTerm(e.target.value); // 검색어 상태 업데이트\n  };\n\n  return (\n    <section className=\"list-wrap\" style={{ width: \"100%\" }}>\n      <div className=\"page-title\">Book List</div>\n\n      {/* 검색바 */}\n      <div className=\"search-wrap\">\n        <div className=\"search-bar\">\n          <input\n            type=\"text\"\n            placeholder=\"제목 또는 저자 검색\"\n            value={searchTerm}\n            onChange={handleSearchChange} // 검색어 입력 변경 처리\n          />\n        </div>\n        <div className=\"write-wrap\">\n          <Link to=\"/book/write\" className=\"btn-primary\">\n            책등록\n          </Link>\n        </div>\n      </div>\n\n      <div className=\"book-list-wrap\">\n        <ul className=\"list-wrap\">\n          {bookList.map((book, i) => {\n            return <BookItem key={i} book={book} setBookList={setBookList} />;\n          })}\n        </ul>\n      </div>\n\n      <div className=\"board-paging-warp\">\n        <PageNavi pi={pi} reqPage={reqPage} setReqPage={setReqPage} />\n      </div>\n    </section>\n  );\n};\n\nconst BookItem = (props) => {\n  const backServer = process.env.REACT_APP_BACK_SERVER;\n  const book = props.book;\n  const navigate = useNavigate();\n  const { setBookList } = props;\n\n  const [stockCount, setStockCount] = useState(book.salesCount); // 재고 상태 추가\n\n  // 재고 수정 함수\n  const handleStockChange = () => {\n    if (stockCount < 0) {\n      Swal.fire({\n        icon: \"error\",\n        title: \"오류\",\n        text: \"재고는 0 이상이어야 합니다.\",\n      });\n      return;\n    }\n\n    axios\n      .put(`${backServer}/api/books/${book.id}/update/${stockCount}`)\n      .then((res) => {\n        Swal.fire({\n          icon: \"success\",\n          title: \"성공\",\n          text: \"재고가 성공적으로 업데이트되었습니다.\",\n        });\n      })\n      .catch((err) => {\n        Swal.fire({\n          icon: \"error\",\n          title: \"오류\",\n          text: \"재고 업데이트 중 오류가 발생했습니다.\",\n        });\n      });\n  };\n\n  // 책 삭제 함수\n  const handleDelete = () => {\n    Swal.fire({\n      title: `${book.title} 책을 삭제하시겠습니까?`,\n      showCancelButton: true,\n      confirmButtonText: \"삭제\",\n      cancelButtonText: \"취소\",\n    }).then((result) => {\n      if (result.isConfirmed) {\n        axios\n          .delete(`${backServer}/api/books/${book.id}`)\n          .then((res) => {\n            Swal.fire({\n              icon: \"success\",\n              title: \"삭제 성공\",\n              text: `${book.title} 책이 삭제되었습니다.`,\n            });\n\n            // 책이 삭제되면 현재 목록에서 해당 책을 제거\n            setBookList((prevList) =>\n              prevList.filter((item) => item.id !== book.id)\n            );\n          })\n          .catch((err) => {\n            Swal.fire({\n              icon: \"error\",\n              title: \"오류\",\n              text: \"책 삭제 중 오류 발생\",\n            });\n          });\n      }\n    });\n  };\n  return (\n    <li className=\"posting-item\">\n      <div className=\"posting-img\">\n        <img\n          src={book.image ? book.image : \"/image/default_img.png\"}\n          alt={book.title}\n          onClick={() => {\n            navigate(`/book/view/${book.id}`);\n          }}\n        />\n      </div>\n      <div className=\"posting-info\">\n        <div className=\"posting-title\">{book.title}</div>\n        <div className=\"posting-sub-info\">\n          <span>저자 : {book.author}</span>\n          <span>출판사 : {book.publisher}</span>\n          <span>판매 : {book.salesCount}</span>\n          <span>\n            재고 :\n            <input\n              type=\"number\"\n              value={stockCount}\n              onChange={(e) => setStockCount(parseInt(e.target.value))}\n              min=\"0\"\n            />\n            <button className=\"btn-list\" onClick={handleStockChange}>\n              수정\n            </button>\n          </span>\n        </div>\n      </div>\n      <div className=\"delete-book\">\n        <button className=\"btn-list\" onClick={handleDelete}>\n          삭제\n        </button>\n      </div>\n    </li>\n  );\n};\n\nexport default BookList;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}