{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{Link,useNavigate}from\"react-router-dom\";import BookUpdate from\"./BookWrite\";import\"./book.css\";import axios from\"axios\";import PageNavi from\"./PageNavi\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BookList=()=>{const backServer=process.env.REACT_APP_BACK_SERVER;const[bookList,setBookList]=useState([]);const[reqPage,setReqPage]=useState(1);const[pi,setPi]=useState({});const[searchTerm,setSearchTerm]=useState(\"\");// 검색어 상태 추가\n// 검색어가 변경될 때마다 호출되는 useEffect\nuseEffect(()=>{setBookList([]);axios.get(`${backServer}/api/books`,{params:{page:reqPage,searchTerm}})// 검색어 추가된 파라미터\n.then(res=>{setBookList(res.data.list);// 목록\nsetPi(res.data.pi);// 페이징\n}).catch(err=>{console.log(err);});},[reqPage,searchTerm]);// 검색어와 페이지가 바뀔 때마다 호출\nconst handleSearchChange=e=>{setSearchTerm(e.target.value);// 검색어 상태 업데이트\n};return/*#__PURE__*/_jsxs(\"section\",{className:\"list-wrap\",style:{width:\"100%\"},children:[/*#__PURE__*/_jsx(\"div\",{className:\"page-title\",children:\"Book List\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-wrap\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-bar\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\uC81C\\uBAA9 \\uB610\\uB294 \\uC800\\uC790 \\uAC80\\uC0C9\",value:searchTerm,onChange:handleSearchChange// 검색어 입력 변경 처리\n})}),/*#__PURE__*/_jsx(\"div\",{className:\"write-wrap\",children:/*#__PURE__*/_jsx(Link,{to:\"/book/write\",className:\"btn-primary\",children:\"\\uCC45\\uB4F1\\uB85D\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"book-list-wrap\",children:/*#__PURE__*/_jsx(\"ul\",{className:\"list-wrap\",children:bookList.map((book,i)=>{return/*#__PURE__*/_jsx(BookItem,{book:book,setBookList:setBookList},i);})})}),/*#__PURE__*/_jsx(\"div\",{className:\"board-paging-warp\",children:/*#__PURE__*/_jsx(PageNavi,{pi:pi,reqPage:reqPage,setReqPage:setReqPage})})]});};const BookItem=props=>{const backServer=process.env.REACT_APP_BACK_SERVER;const book=props.book;const navigate=useNavigate();const{setBookList}=props;const[stockCount,setStockCount]=useState(book.salesCount);// 재고 상태 추가\n// 재고 수정 함수\nconst handleStockChange=()=>{if(stockCount<0){alert(\"재고는 0 이상이어야 합니다.\");return;}// 서버로 재고 수정된 값 전송\naxios.put(`${backServer}/api/books/${book.id}/update/${stockCount}`).then(res=>{console.log(\"재고가 성공적으로 업데이트되었습니다.\",res);}).catch(err=>{console.log(\"재고 업데이트 중 오류 발생\",err);});};// 책 삭제 함수\nconst handleDelete=()=>{const confirmDelete=window.confirm(`${book.title} 책을 삭제하시겠습니까?`);if(confirmDelete){axios.delete(`${backServer}/api/books/${book.id}`).then(res=>{console.log(\"책이 삭제되었습니다.\",res);// 책이 삭제되면 현재 목록에서 해당 책을 제거\nsetBookList(prevList=>prevList.filter(item=>item.id!==book.id));}).catch(err=>{console.log(\"책 삭제 중 오류 발생\",err);});}};return/*#__PURE__*/_jsxs(\"li\",{className:\"posting-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"posting-img\",children:/*#__PURE__*/_jsx(\"img\",{src:book.image?book.image:\"/image/default_img.png\",alt:book.title,onClick:()=>{navigate(`/book/view/${book.id}`);}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"posting-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"posting-title\",children:book.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"posting-sub-info\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\uC800\\uC790 : \",book.author]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\uCD9C\\uD310\\uC0AC : \",book.publisher]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\uD310\\uB9E4 : \",book.salesCount]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\uC7AC\\uACE0 :\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:stockCount,onChange:e=>setStockCount(parseInt(e.target.value)),min:\"0\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-list\",onClick:handleStockChange,children:\"\\uC218\\uC815\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"delete-book\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn-list\",onClick:handleDelete,children:\"\\uC0AD\\uC81C\"})})]});};export default BookList;","map":{"version":3,"names":["React","useEffect","useState","Link","useNavigate","BookUpdate","axios","PageNavi","jsx","_jsx","jsxs","_jsxs","BookList","backServer","process","env","REACT_APP_BACK_SERVER","bookList","setBookList","reqPage","setReqPage","pi","setPi","searchTerm","setSearchTerm","get","params","page","then","res","data","list","catch","err","console","log","handleSearchChange","e","target","value","className","style","width","children","type","placeholder","onChange","to","map","book","i","BookItem","props","navigate","stockCount","setStockCount","salesCount","handleStockChange","alert","put","id","handleDelete","confirmDelete","window","confirm","title","delete","prevList","filter","item","src","image","alt","onClick","author","publisher","parseInt","min"],"sources":["/Users/ori/Desktop/project/book/book_front/src/components/book/BookList.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport BookUpdate from \"./BookWrite\";\nimport \"./book.css\";\nimport axios from \"axios\";\nimport PageNavi from \"./PageNavi\";\n\nconst BookList = () => {\n  const backServer = process.env.REACT_APP_BACK_SERVER;\n  const [bookList, setBookList] = useState([]);\n  const [reqPage, setReqPage] = useState(1);\n  const [pi, setPi] = useState({});\n  const [searchTerm, setSearchTerm] = useState(\"\"); // 검색어 상태 추가\n\n  // 검색어가 변경될 때마다 호출되는 useEffect\n  useEffect(() => {\n    setBookList([]);\n    axios\n      .get(`${backServer}/api/books`, { params: { page: reqPage, searchTerm } }) // 검색어 추가된 파라미터\n      .then((res) => {\n        setBookList(res.data.list); // 목록\n        setPi(res.data.pi); // 페이징\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }, [reqPage, searchTerm]); // 검색어와 페이지가 바뀔 때마다 호출\n\n  const handleSearchChange = (e) => {\n    setSearchTerm(e.target.value); // 검색어 상태 업데이트\n  };\n\n  return (\n    <section className=\"list-wrap\" style={{ width: \"100%\" }}>\n      <div className=\"page-title\">Book List</div>\n\n      {/* 검색바 */}\n      <div className=\"search-wrap\">\n        <div className=\"search-bar\">\n          <input\n            type=\"text\"\n            placeholder=\"제목 또는 저자 검색\"\n            value={searchTerm}\n            onChange={handleSearchChange} // 검색어 입력 변경 처리\n          />\n        </div>\n        <div className=\"write-wrap\">\n          <Link to=\"/book/write\" className=\"btn-primary\">\n            책등록\n          </Link>\n        </div>\n      </div>\n\n      <div className=\"book-list-wrap\">\n        <ul className=\"list-wrap\">\n          {bookList.map((book, i) => {\n            return <BookItem key={i} book={book} setBookList={setBookList} />;\n          })}\n        </ul>\n      </div>\n\n      <div className=\"board-paging-warp\">\n        <PageNavi pi={pi} reqPage={reqPage} setReqPage={setReqPage} />\n      </div>\n    </section>\n  );\n};\n\nconst BookItem = (props) => {\n  const backServer = process.env.REACT_APP_BACK_SERVER;\n  const book = props.book;\n  const navigate = useNavigate();\n  const { setBookList } = props;\n\n  const [stockCount, setStockCount] = useState(book.salesCount); // 재고 상태 추가\n\n  // 재고 수정 함수\n  const handleStockChange = () => {\n    if (stockCount < 0) {\n      alert(\"재고는 0 이상이어야 합니다.\");\n      return;\n    }\n\n    // 서버로 재고 수정된 값 전송\n    axios\n      .put(`${backServer}/api/books/${book.id}/update/${stockCount}`)\n      .then((res) => {\n        console.log(\"재고가 성공적으로 업데이트되었습니다.\", res);\n      })\n      .catch((err) => {\n        console.log(\"재고 업데이트 중 오류 발생\", err);\n      });\n  };\n\n  // 책 삭제 함수\n  const handleDelete = () => {\n    const confirmDelete = window.confirm(\n      `${book.title} 책을 삭제하시겠습니까?`\n    );\n\n    if (confirmDelete) {\n      axios\n        .delete(`${backServer}/api/books/${book.id}`)\n        .then((res) => {\n          console.log(\"책이 삭제되었습니다.\", res);\n\n          // 책이 삭제되면 현재 목록에서 해당 책을 제거\n          setBookList((prevList) =>\n            prevList.filter((item) => item.id !== book.id)\n          );\n        })\n        .catch((err) => {\n          console.log(\"책 삭제 중 오류 발생\", err);\n        });\n    }\n  };\n\n  return (\n    <li className=\"posting-item\">\n      <div className=\"posting-img\">\n        <img\n          src={book.image ? book.image : \"/image/default_img.png\"}\n          alt={book.title}\n          onClick={() => {\n            navigate(`/book/view/${book.id}`);\n          }}\n        />\n      </div>\n      <div className=\"posting-info\">\n        <div className=\"posting-title\">{book.title}</div>\n        <div className=\"posting-sub-info\">\n          <span>저자 : {book.author}</span>\n          <span>출판사 : {book.publisher}</span>\n          <span>판매 : {book.salesCount}</span>\n          <span>\n            재고 :\n            <input\n              type=\"number\"\n              value={stockCount}\n              onChange={(e) => setStockCount(parseInt(e.target.value))}\n              min=\"0\"\n            />\n            <button className=\"btn-list\" onClick={handleStockChange}>\n              수정\n            </button>\n          </span>\n        </div>\n      </div>\n      <div className=\"delete-book\">\n        <button className=\"btn-list\" onClick={handleDelete}>\n          삭제\n        </button>\n      </div>\n    </li>\n  );\n};\n\nexport default BookList;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}